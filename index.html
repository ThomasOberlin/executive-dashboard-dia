<!DOCTYPE html>
<html lang="es-AR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DIA ‚Äî Panel Ejecutivo</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=JetBrains+Mono:wght@300;400;500;600&display=swap');

*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

:root {
    --red: #E31E24;
    --red-dim: rgba(227,30,36,0.12);
    --red-glow: rgba(227,30,36,0.25);
    --bg: #0d0d0f;
    --bg-2: #131316;
    --bg-3: #1a1a1f;
    --bg-4: #212127;
    --border: rgba(255,255,255,0.07);
    --border-2: rgba(255,255,255,0.12);
    --text: #f0f0f2;
    --text-2: #8888a0;
    --text-3: #55555f;
    --green: #00d68f;
    --green-dim: rgba(0,214,143,0.1);
    --amber: #f59e0b;
    --amber-dim: rgba(245,158,11,0.1);
    --blue: #4a9eff;
    --blue-dim: rgba(74,158,255,0.1);
    --mono: 'JetBrains Mono', monospace;
    --display: 'Syne', sans-serif;
}

html { scroll-behavior: smooth; }

body {
    font-family: var(--display);
    background: var(--bg);
    color: var(--text);
    font-size: 13px;
    line-height: 1.5;
    min-height: 100vh;
    overflow-x: hidden;
}

body::before {
    content: '';
    position: fixed; inset: 0; z-index: 0; pointer-events: none;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
    opacity: 0.4;
}

.header {
    position: sticky; top: 0; z-index: 200;
    background: rgba(13,13,15,0.92);
    backdrop-filter: blur(16px);
    border-bottom: 1px solid var(--border-2);
    padding: 0 2rem;
    height: 58px;
    display: flex; align-items: center; justify-content: space-between;
}

.header-left { display: flex; align-items: center; gap: 2rem; }

.logo-block { display: flex; align-items: center; gap: 0.875rem; }
.logo-mark {
    width: 36px; height: 36px; background: var(--red);
    border-radius: 8px; display: flex; align-items: center; justify-content: center;
    font-size: 1rem; font-weight: 800; letter-spacing: 1px; color: white;
    box-shadow: 0 0 20px var(--red-glow);
}
.logo-text { font-size: 0.7rem; font-weight: 600; letter-spacing: 2px; color: var(--text-2); text-transform: uppercase; }
.logo-role { font-size: 0.65rem; color: var(--text-3); letter-spacing: 1px; }

.header-divider { width: 1px; height: 24px; background: var(--border-2); }

.live-indicator {
    display: flex; align-items: center; gap: 0.5rem;
    font-size: 0.68rem; font-family: var(--mono); color: var(--text-2); letter-spacing: 0.5px;
}
.live-dot {
    width: 6px; height: 6px; border-radius: 50%; background: var(--green);
    box-shadow: 0 0 8px var(--green);
    animation: livePulse 2.5s ease-in-out infinite;
}
@keyframes livePulse { 0%,100%{ opacity:1; box-shadow:0 0 8px var(--green); } 50%{ opacity:0.5; box-shadow:0 0 3px var(--green); } }

.header-right { display: flex; align-items: center; gap: 1rem; }
.header-time { font-family: var(--mono); font-size: 0.8rem; color: var(--text-2); }

/* Language toggle */
.lang-toggle {
    display: flex; gap: 2px;
    background: var(--bg-4); border-radius: 6px; padding: 2px;
}
.lang-btn {
    padding: 0.25rem 0.625rem; border-radius: 4px;
    font-size: 0.68rem; font-family: var(--mono); font-weight: 600;
    cursor: pointer; border: none; background: transparent;
    color: var(--text-3); transition: all 0.15s; letter-spacing: 0.5px;
}
.lang-btn.active { background: var(--bg-2); color: var(--text); }

.header-actions { display: flex; gap: 0.5rem; }
.hbtn {
    padding: 0.375rem 0.875rem; border-radius: 6px; font-size: 0.72rem;
    font-family: var(--display); font-weight: 500; cursor: pointer;
    border: 1px solid var(--border-2); background: var(--bg-3);
    color: var(--text-2); transition: all 0.15s; letter-spacing: 0.3px;
}
.hbtn:hover { border-color: var(--red); color: var(--text); }
.hbtn.primary {
    background: var(--red); border-color: var(--red); color: white;
    box-shadow: 0 2px 12px var(--red-glow);
}
.hbtn.primary:hover { box-shadow: 0 4px 20px var(--red-glow); }

.main {
    position: relative; z-index: 1;
    padding: 1.75rem 2rem;
    max-width: 1600px; margin: 0 auto;
    display: flex; flex-direction: column; gap: 1.5rem;
}

.section-label {
    font-size: 0.65rem; font-weight: 600; letter-spacing: 2.5px;
    text-transform: uppercase; color: var(--text-3);
    margin-bottom: 0.875rem;
    display: flex; align-items: center; gap: 0.75rem;
}
.section-label::after { content: ''; flex: 1; height: 1px; background: var(--border); }

.kpi-strip {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 1px;
    background: var(--border);
    border-radius: 12px; overflow: hidden;
    border: 1px solid var(--border);
}
.kpi-cell {
    background: var(--bg-2);
    padding: 1.25rem 1.5rem;
    position: relative;
    transition: background 0.15s;
    cursor: default;
}
.kpi-cell:hover { background: var(--bg-3); }
.kpi-cell.primary { background: var(--bg-3); }
.kpi-cell.alert { background: rgba(227,30,36,0.05); }

.kpi-label {
    font-size: 0.65rem; font-weight: 600; letter-spacing: 1.5px;
    text-transform: uppercase; color: var(--text-3); margin-bottom: 0.625rem;
}
.kpi-value {
    font-family: var(--mono); font-size: 1.75rem; font-weight: 500;
    color: var(--text); line-height: 1; margin-bottom: 0.5rem;
}
.kpi-value.red { color: var(--red); }
.kpi-value.green { color: var(--green); }
.kpi-value.amber { color: var(--amber); }
.kpi-meta {
    display: flex; align-items: center; gap: 0.5rem;
    font-family: var(--mono); font-size: 0.68rem;
}
.delta { font-weight: 500; }
.delta.up { color: var(--green); }
.delta.down { color: var(--red); }
.delta-period { color: var(--text-3); }

.kpi-accent-bar {
    position: absolute; bottom: 0; left: 0;
    height: 2px; background: var(--red);
    transition: width 1.2s ease;
}

.decisions-wrapper {
    display: grid;
    grid-template-columns: 1fr 340px;
    gap: 1rem;
}

.decisions-panel {
    background: var(--bg-2);
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
}
.decisions-header {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--border);
    display: flex; justify-content: space-between; align-items: center;
}
.decisions-title {
    font-size: 0.95rem; font-weight: 700; color: var(--text);
    display: flex; align-items: center; gap: 0.625rem;
}
.decisions-badge {
    background: var(--red); color: white;
    font-size: 0.65rem; font-family: var(--mono); font-weight: 600;
    padding: 0.125rem 0.5rem; border-radius: 10px;
}
.decisions-meta { font-size: 0.72rem; color: var(--text-3); font-family: var(--mono); }

.decision-row {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--border);
    display: grid;
    grid-template-columns: 3px 1fr auto;
    gap: 1rem; align-items: center;
    transition: background 0.15s;
    cursor: pointer;
}
.decision-row:hover { background: var(--bg-3); }
.decision-row:last-child { border-bottom: none; }

.decision-priority-bar { width: 3px; border-radius: 3px; align-self: stretch; min-height: 60px; }
.priority-critical { background: var(--red); box-shadow: 0 0 8px var(--red-glow); }
.priority-high { background: var(--amber); }
.priority-medium { background: var(--blue); }

.decision-body { flex: 1; min-width: 0; }
.decision-store {
    font-size: 0.65rem; font-weight: 600; letter-spacing: 1.5px;
    text-transform: uppercase; color: var(--text-3); margin-bottom: 0.25rem;
}
.decision-product { font-size: 0.9rem; font-weight: 700; margin-bottom: 0.375rem; }
.decision-detail { font-family: var(--mono); font-size: 0.75rem; color: var(--text-2); }
.decision-tags { margin-top: 0.5rem; display: flex; gap: 0.375rem; flex-wrap: wrap; }
.dtag {
    font-size: 0.65rem; font-family: var(--mono);
    padding: 0.15rem 0.5rem; border-radius: 4px;
    border: 1px solid var(--border-2); color: var(--text-3);
}
.dtag.red { border-color: rgba(227,30,36,0.3); color: var(--red); background: var(--red-dim); }
.dtag.green { border-color: rgba(0,214,143,0.2); color: var(--green); background: var(--green-dim); }
.dtag.amber { border-color: rgba(245,158,11,0.2); color: var(--amber); background: var(--amber-dim); }

.decision-action { flex-shrink: 0; text-align: right; }
.decision-recovery { font-family: var(--mono); font-size: 1.1rem; font-weight: 600; color: var(--green); }
.decision-recovery-label { font-size: 0.65rem; color: var(--text-3); margin-bottom: 0.5rem; letter-spacing: 0.5px; }
.approve-btn {
    display: block; width: 100%; margin-top: 0.5rem;
    padding: 0.5rem 1rem; border-radius: 6px;
    background: var(--red); color: white; border: none;
    font-family: var(--display); font-size: 0.72rem; font-weight: 600;
    cursor: pointer; transition: all 0.15s; white-space: nowrap;
    letter-spacing: 0.3px;
}
.approve-btn:hover { box-shadow: 0 4px 16px var(--red-glow); transform: translateY(-1px); }
.approve-btn.approved { background: var(--green); box-shadow: none; }
.preview-btn {
    display: block; width: 100%; margin-top: 0.375rem;
    padding: 0.375rem 1rem; border-radius: 6px;
    background: transparent; color: var(--text-3);
    border: 1px solid var(--border-2);
    font-family: var(--display); font-size: 0.7rem;
    cursor: pointer; transition: all 0.15s;
}
.preview-btn:hover { color: var(--text); }

.network-panel {
    background: var(--bg-2);
    border: 1px solid var(--border);
    border-radius: 12px; overflow: hidden;
}
.network-header {
    padding: 1rem 1.25rem;
    border-bottom: 1px solid var(--border);
    font-size: 0.85rem; font-weight: 700;
}
.network-row {
    padding: 0.875rem 1.25rem;
    border-bottom: 1px solid var(--border);
    cursor: pointer; transition: background 0.15s;
}
.network-row:hover { background: var(--bg-3); }
.network-row:last-child { border-bottom: none; }
.network-row-top {
    display: flex; justify-content: space-between; align-items: baseline;
    margin-bottom: 0.375rem;
}
.network-store-name { font-size: 0.8rem; font-weight: 700; }
.network-revenue { font-family: var(--mono); font-size: 0.875rem; font-weight: 500; }
.network-row-bottom {
    display: flex; justify-content: space-between; align-items: center; gap: 0.5rem;
}
.network-store-type { font-size: 0.65rem; color: var(--text-3); }
.network-bar-wrap { flex: 1; height: 4px; background: var(--bg-4); border-radius: 2px; overflow: hidden; }
.network-bar { height: 100%; border-radius: 2px; transition: width 1s ease; }
.network-metrics { display: flex; gap: 0.75rem; }
.nmval { font-family: var(--mono); font-size: 0.68rem; }
.nmval.danger { color: var(--red); }
.nmval.good { color: var(--green); }
.health-dot { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; display: inline-block; margin-left: 0.375rem; }

.bottom-row {
    display: grid;
    grid-template-columns: 1fr 1fr 400px;
    gap: 1rem;
}

.chart-panel {
    background: var(--bg-2);
    border: 1px solid var(--border);
    border-radius: 12px; overflow: hidden;
}
.chart-header {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--border);
    display: flex; justify-content: space-between; align-items: center;
}
.chart-title { font-size: 0.875rem; font-weight: 700; }
.chart-legend { display: flex; gap: 1rem; }
.legend-item { display: flex; align-items: center; gap: 0.375rem; font-size: 0.68rem; color: var(--text-3); font-family: var(--mono); }
.legend-dot { width: 8px; height: 8px; border-radius: 2px; }

.bar-chart-wrap { padding: 1.25rem 1.5rem 0.5rem; }
.bar-chart { display: flex; align-items: flex-end; gap: 0.5rem; height: 120px; }
.bar-group { flex: 1; display: flex; gap: 2px; align-items: flex-end; }
.bar {
    flex: 1; border-radius: 3px 3px 0 0;
    transition: height 0.8s cubic-bezier(0.34,1.56,0.64,1);
    cursor: pointer; position: relative;
}
.bar:hover::after {
    content: attr(data-val);
    position: absolute; bottom: calc(100% + 4px); left: 50%; transform: translateX(-50%);
    background: var(--bg-4); border: 1px solid var(--border-2);
    color: var(--text); font-family: var(--mono); font-size: 0.65rem;
    padding: 0.2rem 0.4rem; border-radius: 4px; white-space: nowrap; z-index: 10;
}
.bar-risk { background: rgba(227,30,36,0.5); }
.bar-risk:hover { background: rgba(227,30,36,0.8); }
.bar-recovered { background: rgba(0,214,143,0.5); }
.bar-recovered:hover { background: rgba(0,214,143,0.8); }

.bar-labels { display: flex; gap: 0.5rem; padding: 0.625rem 1.5rem 1rem; }
.bar-label { flex: 1; text-align: center; font-size: 0.65rem; font-family: var(--mono); color: var(--text-3); }

.chart-footer {
    padding: 0.875rem 1.5rem;
    border-top: 1px solid var(--border);
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 1rem;
}
.chart-stat-val { font-family: var(--mono); font-size: 1.1rem; font-weight: 500; }
.chart-stat-lbl { font-size: 0.65rem; color: var(--text-3); letter-spacing: 0.5px; margin-top: 0.15rem; }

.wins-panel {
    background: var(--bg-2);
    border: 1px solid var(--border);
    border-radius: 12px; overflow: hidden;
}
.wins-header {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--border);
    display: flex; justify-content: space-between; align-items: center;
}
.wins-title { font-size: 0.875rem; font-weight: 700; }
.wins-period { font-family: var(--mono); font-size: 0.68rem; color: var(--text-3); }

.win-row {
    padding: 0.875rem 1.5rem;
    border-bottom: 1px solid var(--border);
    display: flex; justify-content: space-between; align-items: center; gap: 1rem;
}
.win-row:last-child { border-bottom: none; }
.win-rank { font-family: var(--mono); font-size: 0.65rem; color: var(--text-3); width: 20px; flex-shrink: 0; }
.win-body { flex: 1; min-width: 0; }
.win-name { font-size: 0.8rem; font-weight: 600; margin-bottom: 0.2rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.win-detail { font-family: var(--mono); font-size: 0.68rem; color: var(--text-3); }
.win-metric { text-align: right; flex-shrink: 0; }
.win-coc { font-family: var(--mono); font-size: 1rem; font-weight: 600; color: var(--green); }
.win-coc-lbl { font-size: 0.62rem; color: var(--text-3); }

.store-scorecards {
    display: grid; grid-template-columns: repeat(2, 1fr); gap: 1px;
    background: var(--border); border-radius: 12px; overflow: hidden;
    border: 1px solid var(--border);
}
.scorecard {
    background: var(--bg-2); padding: 1rem 1.25rem;
    cursor: pointer; transition: background 0.15s;
}
.scorecard:hover { background: var(--bg-3); }
.sc-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.75rem; }
.sc-name { font-size: 0.8rem; font-weight: 700; }
.sc-type { font-size: 0.62rem; color: var(--text-3); letter-spacing: 0.5px; margin-top: 0.15rem; }
.sc-health {
    font-size: 0.65rem; font-family: var(--mono); font-weight: 600;
    padding: 0.2rem 0.5rem; border-radius: 4px;
}
.health-ok { background: var(--green-dim); color: var(--green); }
.health-warn { background: var(--amber-dim); color: var(--amber); }
.health-crit { background: var(--red-dim); color: var(--red); }

.sc-metrics { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; }
.sc-m-val { font-family: var(--mono); font-size: 0.9rem; font-weight: 500; }
.sc-m-lbl { font-size: 0.62rem; color: var(--text-3); margin-top: 0.1rem; }

.sc-footer { margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
.sc-ai-opp { font-size: 0.72rem; }
.sc-ai-opp strong { color: var(--green); font-family: var(--mono); }
.sc-manager { font-size: 0.65rem; color: var(--text-3); }

.alerts-bar {
    background: var(--bg-2);
    border: 1px solid var(--border);
    border-radius: 12px; padding: 0.875rem 1.5rem;
    display: flex; align-items: center; gap: 1.5rem;
}
.alerts-label { font-size: 0.65rem; font-weight: 600; letter-spacing: 1.5px; text-transform: uppercase; color: var(--text-3); flex-shrink: 0; }
.alerts-scroll { display: flex; gap: 1rem; overflow-x: auto; -webkit-overflow-scrolling: touch; padding-bottom: 2px; }
.alert-chip {
    display: flex; align-items: center; gap: 0.5rem;
    padding: 0.375rem 0.75rem; border-radius: 6px;
    font-size: 0.72rem; font-family: var(--mono); white-space: nowrap;
    cursor: pointer; transition: all 0.15s; flex-shrink: 0;
    border: 1px solid;
}
.alert-chip.crit { background: var(--red-dim); border-color: rgba(227,30,36,0.3); color: var(--red); }
.alert-chip.warn { background: var(--amber-dim); border-color: rgba(245,158,11,0.2); color: var(--amber); }
.alert-chip.info { background: var(--blue-dim); border-color: rgba(74,158,255,0.2); color: var(--blue); }
.alert-chip:hover { transform: translateY(-1px); }

.modal-overlay {
    position: fixed; inset: 0; z-index: 500;
    background: rgba(0,0,0,0.75); backdrop-filter: blur(8px);
    display: none; align-items: center; justify-content: center; padding: 1.5rem;
}
.modal-overlay.open { display: flex; }
.modal {
    background: var(--bg-2); border: 1px solid var(--border-2);
    border-radius: 16px; max-width: 520px; width: 100%;
    max-height: 90vh; overflow-y: auto;
    animation: modalIn 0.2s ease-out;
    box-shadow: 0 24px 60px rgba(0,0,0,0.5);
}
@keyframes modalIn { from { opacity:0; transform:scale(0.95) translateY(8px); } to { opacity:1; transform:scale(1) translateY(0); } }
.modal-header {
    padding: 1.5rem 1.5rem 1rem;
    border-bottom: 1px solid var(--border);
    display: flex; justify-content: space-between; align-items: flex-start;
}
.modal-title { font-size: 1.1rem; font-weight: 700; }
.modal-close-btn {
    background: var(--bg-4); border: 1px solid var(--border-2);
    color: var(--text-2); border-radius: 6px; width: 28px; height: 28px;
    cursor: pointer; font-size: 0.875rem; display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
}
.modal-close-btn:hover { color: var(--text); }
.modal-body { padding: 1.5rem; }
.modal-metric-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 1.25rem; }
.modal-metric { background: var(--bg-3); border-radius: 8px; padding: 1rem; }
.modal-metric-val { font-family: var(--mono); font-size: 1.5rem; font-weight: 500; margin-bottom: 0.25rem; }
.modal-metric-lbl { font-size: 0.68rem; color: var(--text-3); letter-spacing: 0.5px; }
.modal-section { margin-bottom: 1.25rem; }
.modal-section-title { font-size: 0.7rem; font-weight: 600; letter-spacing: 1.5px; text-transform: uppercase; color: var(--text-3); margin-bottom: 0.75rem; }
.strat-compare { display: flex; flex-direction: column; gap: 0.5rem; }
.strat-row { display: flex; align-items: center; gap: 0.75rem; }
.strat-name { font-size: 0.78rem; width: 140px; flex-shrink: 0; }
.strat-bar-wrap { flex: 1; background: var(--bg-4); border-radius: 2px; height: 20px; overflow: hidden; }
.strat-bar-fill { height: 100%; border-radius: 2px; display: flex; align-items: center; padding-left: 0.5rem; }
.strat-bar-fill span { font-family: var(--mono); font-size: 0.68rem; font-weight: 600; color: white; }
.modal-actions { display: flex; gap: 0.75rem; margin-top: 1.5rem; }
.mbtn { flex: 1; padding: 0.75rem; border-radius: 8px; font-family: var(--display); font-size: 0.8rem; font-weight: 600; cursor: pointer; border: none; transition: all 0.15s; }
.mbtn.primary { background: var(--red); color: white; }
.mbtn.primary:hover { box-shadow: 0 4px 16px var(--red-glow); }
.mbtn.ghost { background: var(--bg-4); color: var(--text-2); border: 1px solid var(--border-2); }
.mbtn.ghost:hover { color: var(--text); }

.animate-in { animation: fadeSlideIn 0.4s ease-out both; }
@keyframes fadeSlideIn { from { opacity:0; transform:translateY(12px); } to { opacity:1; transform:translateY(0); } }
.delay-1 { animation-delay: 0.05s; }
.delay-2 { animation-delay: 0.1s; }
.delay-3 { animation-delay: 0.15s; }
.delay-4 { animation-delay: 0.2s; }
.delay-5 { animation-delay: 0.25s; }

::-webkit-scrollbar { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--bg-4); border-radius: 2px; }
</style>
</head>
<body>

<header class="header">
    <div class="header-left">
        <div class="logo-block">
            <div class="logo-mark">DIA</div>
            <div>
                <div class="logo-text" data-es="Panel Ejecutivo" data-en="Executive Dashboard">Panel Ejecutivo</div>
                <div class="logo-role" data-es="Presidencia ¬∑ Red Argentina" data-en="Presidency ¬∑ Argentine Network">Presidencia ¬∑ Red Argentina</div>
            </div>
        </div>
        <div class="header-divider"></div>
        <div class="live-indicator">
            <div class="live-dot"></div>
            <span data-es="EN VIVO ¬∑ ACTUALIZADO" data-en="LIVE ¬∑ UPDATED">EN VIVO ¬∑ ACTUALIZADO</span>
            <span id="header-time" style="color:var(--text);">‚Äî</span>
        </div>
    </div>
    <div class="header-right">
        <div class="header-time" id="header-date">‚Äî</div>
        <div class="lang-toggle">
            <button class="lang-btn active" id="btn-es" onclick="setLang('es')">ES</button>
            <button class="lang-btn" id="btn-en" onclick="setLang('en')">EN</button>
        </div>
        <div class="header-actions">
            <button class="hbtn" onclick="exportDashboard()" data-es="‚Üì Exportar" data-en="‚Üì Export">‚Üì Exportar</button>
            <button class="hbtn" onclick="window.location.href='dia-enhanced.html'" data-es="‚¨° Ops" data-en="‚¨° Ops">‚¨° Ops</button>
            <button class="hbtn primary" onclick="approveAll()" data-es="‚úì Aprobar Todo" data-en="‚úì Approve All">‚úì Aprobar Todo</button>
        </div>
    </div>
</header>

<div class="main">

    <div class="animate-in delay-1">
        <div class="section-label" id="lbl-kpi" data-es="Red Nacional ¬∑ 6 Sucursales ¬∑ KPIs Consolidados" data-en="National Network ¬∑ 6 Branches ¬∑ Consolidated KPIs">Red Nacional ¬∑ 6 Sucursales ¬∑ KPIs Consolidados</div>
        <div class="kpi-strip" id="kpi-strip"></div>
    </div>

    <div class="decisions-wrapper animate-in delay-2">
        <div class="decisions-panel">
            <div class="decisions-header">
                <div class="decisions-title">
                    <span data-es="Decisiones Pendientes de Aprobaci√≥n" data-en="Decisions Pending Approval">Decisiones Pendientes de Aprobaci√≥n</span>
                    <span class="decisions-badge" id="decisions-count">‚Äî</span>
                </div>
                <div class="decisions-meta" data-es="Generadas por Motor IA ¬∑ Ordenadas por impacto" data-en="Generated by AI Engine ¬∑ Ranked by impact">Generadas por Motor IA ¬∑ Ordenadas por impacto</div>
            </div>
            <div id="decisions-list"></div>
        </div>
        <div class="network-panel">
            <div class="network-header" data-es="Desempe√±o por Sucursal" data-en="Performance by Branch">Desempe√±o por Sucursal</div>
            <div id="network-rows"></div>
        </div>
    </div>

    <div class="animate-in delay-3">
        <div class="section-label" id="lbl-scorecards" data-es="Tarjetas de Sucursal ¬∑ Click para detalle" data-en="Branch Cards ¬∑ Click for detail">Tarjetas de Sucursal ¬∑ Click para detalle</div>
        <div class="store-scorecards" id="store-scorecards"></div>
    </div>

    <div class="bottom-row animate-in delay-4">
        <div class="chart-panel">
            <div class="chart-header">
                <div class="chart-title" data-es="Valor en Riesgo vs. Recuperado por IA" data-en="Value at Risk vs. Recovered by AI">Valor en Riesgo vs. Recuperado por IA</div>
                <div class="chart-legend">
                    <div class="legend-item"><div class="legend-dot" style="background:rgba(227,30,36,0.5);"></div><span data-es="En Riesgo" data-en="At Risk">En Riesgo</span></div>
                    <div class="legend-item"><div class="legend-dot" style="background:rgba(0,214,143,0.5);"></div><span data-es="Recuperado" data-en="Recovered">Recuperado</span></div>
                </div>
            </div>
            <div class="bar-chart-wrap">
                <div class="bar-chart" id="waste-chart"></div>
            </div>
            <div class="bar-labels" id="waste-chart-labels"></div>
            <div class="chart-footer" id="waste-chart-footer"></div>
        </div>

        <div class="wins-panel">
            <div class="wins-header">
                <div class="wins-title" data-es="üèÜ Top Resultados IA del Mes" data-en="üèÜ Top AI Results of the Month">üèÜ Top Resultados IA del Mes</div>
                <div class="wins-period" data-es="Retorno Cash/Cash" data-en="Cash-on-Cash Return">Retorno Cash/Cash</div>
            </div>
            <div id="wins-list"></div>
        </div>

        <div style="display:flex; flex-direction:column; gap:1rem;">
            <div class="chart-panel" style="flex:1;">
                <div class="chart-header">
                    <div class="chart-title" data-es="Resumen de Merma Proyectada" data-en="Projected Waste Summary">Resumen de Merma Proyectada</div>
                </div>
                <div style="padding:1rem 1.5rem; display:flex; flex-direction:column; gap:0.875rem;" id="waste-summary"></div>
            </div>
            <div class="chart-panel">
                <div class="chart-header">
                    <div class="chart-title" data-es="Modelo IA ¬∑ Estado" data-en="AI Model ¬∑ Status">Modelo IA ¬∑ Estado</div>
                </div>
                <div style="padding:1rem 1.5rem; display:flex; flex-direction:column; gap:0.625rem;" id="model-status"></div>
            </div>
        </div>
    </div>

    <div class="animate-in delay-5">
        <div class="alerts-bar">
            <div class="alerts-label" data-es="Alertas Activas" data-en="Active Alerts">Alertas Activas</div>
            <div class="alerts-scroll" id="alerts-scroll"></div>
        </div>
    </div>

</div>

<div class="modal-overlay" id="modal-overlay" onclick="closeModal(event)">
    <div class="modal" id="modal">
        <div class="modal-header">
            <div>
                <div class="modal-title" id="modal-title">‚Äî</div>
                <div style="font-size:0.72rem; color:var(--text-3); margin-top:0.25rem;" id="modal-subtitle">‚Äî</div>
            </div>
            <button class="modal-close-btn" onclick="closeModalDirect()">‚úï</button>
        </div>
        <div class="modal-body">
            <div class="modal-metric-row" id="modal-metrics"></div>
            <div class="modal-section">
                <div class="modal-section-title" data-es="Comparativa de Estrategias" data-en="Strategy Comparison">Comparativa de Estrategias</div>
                <div class="strat-compare" id="modal-strats"></div>
            </div>
            <div class="modal-section">
                <div class="modal-section-title" data-es="Clientes Objetivo" data-en="Target Customers">Clientes Objetivo</div>
                <div id="modal-customers" style="font-size:0.8rem; color:var(--text-2); line-height:1.7;"></div>
            </div>
            <div class="modal-actions">
                <button class="mbtn primary" id="modal-approve" onclick="approveFromModal()">üöÄ <span data-es="Aprobar y Lanzar" data-en="Approve and Launch">Aprobar y Lanzar</span></button>
                <button class="mbtn ghost" onclick="closeModalDirect()" data-es="Cancelar" data-en="Cancel">Cancelar</button>
            </div>
        </div>
    </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// LANGUAGE SYSTEM
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let currentLang = 'es';

const T = {
    es: {
        // KPI labels
        kpi_sales: 'Ventas YTD ¬∑ Red',
        kpi_clients: 'Clientes Activos ¬∑ Red',
        kpi_basket: 'Ticket Promedio ¬∑ Red',
        kpi_risk: 'SKUs en Riesgo ¬∑ Red',
        kpi_recovery: 'Tasa Recuperaci√≥n IA',
        period_prev_year: 'vs a√±o anterior',
        period_prev_week: 'vs semana anterior',
        period_prev_month: 'vs mes anterior',
        period_branches: 'en {n} sucursales',
        period_no_ai: 'vs mes anterior sin IA',
        // Decision tags
        risk_tag: 'Riesgo: ${v}K',
        recovery_tag: 'Recuperaci√≥n est.: ${v}K',
        coc_return: 'RETORNO C/C',
        approve: '‚ñ∂ Aprobar',
        approved: '‚úì Aprobado',
        see_detail: 'Ver detalle',
        // Network
        health_ok: '‚úì OK', health_warn: '‚ö† Atenci√≥n', health_crit: '‚úï Cr√≠tico',
        // Scorecards
        health_s_ok: '‚úì Saludable', health_s_warn: '‚ö† Atenci√≥n', health_s_crit: '‚úï Cr√≠tico',
        sales_ytd: 'Ventas YTD', avg_ticket: 'Ticket prom.',
        clients: 'Clientes', risk_skus: 'SKUs riesgo',
        ai_rec: 'Rec. IA', employees: 'Empleados',
        ai_opp: 'Oportunidad IA',
        recoverable: 'recuperables',
        // Chart
        chart_risk_label: '${v}M en riesgo',
        chart_rec_label: '${v}M recuperado',
        chart_total_risk: 'TOTAL EN RIESGO (4 SEM)',
        chart_recovered: 'RECUPERADO POR IA (${pct}%)',
        // Waste summary
        gross_exposure: 'Exposici√≥n bruta (mes)',
        recovered_ai: 'Recuperado por IA',
        net_exposure: 'Exposici√≥n neta',
        ai_capture: 'Tasa de captura IA',
        // Model status
        last_retrain: '√öltimo reentrenamiento',
        today: 'Hoy',
        // Alerts
        alerts: [
            '‚ö° Mendoza: 4 SKUs vencen ma√±ana ¬∑ $186K en riesgo',
            '‚ö° San Isidro: Salm√≥n 41 unidades ¬∑ 3 d√≠as',
            '‚ö† Mendoza: Clientes locales con tendencia ‚Üì ‚àí12.8%',
            '‚ö† Quilmes: Frecuencia de visita cay√≥ 2.4‚Üí2.2x',
            'üìä Modelo reentrenado con 847K registros nuevos',
            'üèÜ Campa√±a Mar del Plata: 61% conversi√≥n ¬∑ $178K recuperados',
            'üìÖ Partido Boca-River el 12/09 ¬∑ Ajustar stock Carnes+Bebidas',
            '‚ö† C√≥rdoba: Per√≠odo de ex√°menes ¬∑ Demanda energizantes +40%',
        ],
        // Modal
        value_at_risk: 'VALOR EN RIESGO',
        est_recovery: 'RECUPERACI√ìN ESTIMADA',
        coc_return_lbl: 'RETORNO CASH/CASH',
        optimal_strategy: 'ESTRATEGIA √ìPTIMA',
        campaign_approved: '‚úì Campa√±a Aprobada',
        approve_launch: 'üöÄ Aprobar y Lanzar',
        // Export
        export_msg: 'Informe ejecutivo PDF generado: DIA_Panel_Ejecutivo_',
    },
    en: {
        kpi_sales: 'YTD Sales ¬∑ Network',
        kpi_clients: 'Active Clients ¬∑ Network',
        kpi_basket: 'Avg. Basket ¬∑ Network',
        kpi_risk: 'SKUs at Risk ¬∑ Network',
        kpi_recovery: 'AI Recovery Rate',
        period_prev_year: 'vs prior year',
        period_prev_week: 'vs prior week',
        period_prev_month: 'vs prior month',
        period_branches: 'across {n} branches',
        period_no_ai: 'vs prior month without AI',
        risk_tag: 'Risk: ${v}K',
        recovery_tag: 'Est. Recovery: ${v}K',
        coc_return: 'C/C RETURN',
        approve: '‚ñ∂ Approve',
        approved: '‚úì Approved',
        see_detail: 'View detail',
        health_ok: '‚úì OK', health_warn: '‚ö† Attention', health_crit: '‚úï Critical',
        health_s_ok: '‚úì Healthy', health_s_warn: '‚ö† Attention', health_s_crit: '‚úï Critical',
        sales_ytd: 'YTD Sales', avg_ticket: 'Avg. basket',
        clients: 'Clients', risk_skus: 'SKUs at risk',
        ai_rec: 'AI Rec.', employees: 'Employees',
        ai_opp: 'AI Opportunity',
        recoverable: 'recoverable',
        chart_risk_label: '${v}M at risk',
        chart_rec_label: '${v}M recovered',
        chart_total_risk: 'TOTAL AT RISK (4 WKS)',
        chart_recovered: 'RECOVERED BY AI (${pct}%)',
        gross_exposure: 'Gross exposure (month)',
        recovered_ai: 'Recovered by AI',
        net_exposure: 'Net exposure',
        ai_capture: 'AI capture rate',
        last_retrain: 'Last retraining',
        today: 'Today',
        alerts: [
            '‚ö° Mendoza: 4 SKUs expire tomorrow ¬∑ $186K at risk',
            '‚ö° San Isidro: Salmon 41 units ¬∑ 3 days',
            '‚ö† Mendoza: Local clients trending ‚Üì ‚àí12.8%',
            '‚ö† Quilmes: Visit frequency dropped 2.4‚Üí2.2x',
            'üìä Model retrained with 847K new records',
            'üèÜ Mar del Plata campaign: 61% conversion ¬∑ $178K recovered',
            'üìÖ Boca-River match 12/09 ¬∑ Adjust Meat+Beverage stock',
            '‚ö† C√≥rdoba: Exam period ¬∑ Energy drink demand +40%',
        ],
        value_at_risk: 'VALUE AT RISK',
        est_recovery: 'ESTIMATED RECOVERY',
        coc_return_lbl: 'CASH/CASH RETURN',
        optimal_strategy: 'OPTIMAL STRATEGY',
        campaign_approved: '‚úì Campaign Approved',
        approve_launch: 'üöÄ Approve and Launch',
        export_msg: 'Executive PDF report generated: DIA_Executive_Dashboard_',
    }
};

function t(key, vars) {
    let str = T[currentLang][key] || T['es'][key] || key;
    if (vars) Object.entries(vars).forEach(([k,v]) => { str = str.replace(`{${k}}`, v); });
    return str;
}

function setLang(lang) {
    currentLang = lang;
    document.getElementById('btn-es').classList.toggle('active', lang === 'es');
    document.getElementById('btn-en').classList.toggle('active', lang === 'en');
    document.documentElement.lang = lang === 'es' ? 'es-AR' : 'en';
    // Update all static data-es/data-en elements
    document.querySelectorAll('[data-es]').forEach(el => {
        el.textContent = lang === 'es' ? el.dataset.es : el.dataset.en;
    });
    // Re-render all dynamic sections
    renderKPIStrip();
    renderDecisions();
    renderNetworkRows();
    renderScorecards();
    renderWasteChart();
    renderWins();
    renderWasteSummary();
    renderAlerts();
    updateClock();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const STORES = [
    {
        id: 'bsas_centro', name: 'Buenos Aires Centro', shortName: 'CABA',
        type_es: 'Urbano Compacto', type_en: 'Compact Urban',
        manager: 'Mar√≠a Gonz√°lez', size: '450m¬≤',
        revenue: 18_450_680, revPrev: 16_890_750,
        clients: 1890, clientsPrev: 1756,
        avgBasket: 2450, basketPrev: 2285,
        perishable: 85, atRisk: 7,
        health: 'ok',
        waste: { current: 1_240_000, recovered: 890_000 }
    },
    {
        id: 'zona_norte', name: 'San Isidro', shortName: 'ZON',
        type_es: 'Hipermercado Familiar', type_en: 'Family Hypermarket',
        manager: 'Carlos Mendez', size: '1200m¬≤',
        revenue: 42_450_680, revPrev: 38_890_750,
        clients: 3245, clientsPrev: 3089,
        avgBasket: 5250, basketPrev: 4965,
        perishable: 156, atRisk: 14,
        health: 'ok',
        waste: { current: 3_100_000, recovered: 2_200_000 }
    },
    {
        id: 'zona_sur', name: 'Quilmes', shortName: 'ZSR',
        type_es: 'Barrial', type_en: 'Neighborhood',
        manager: 'Liliana Fern√°ndez', size: '680m¬≤',
        revenue: 22_450_680, revPrev: 21_090_750,
        clients: 2845, clientsPrev: 2756,
        avgBasket: 1967, basketPrev: 1845,
        perishable: 95, atRisk: 9,
        health: 'warn',
        waste: { current: 1_800_000, recovered: 1_100_000 }
    },
    {
        id: 'cordoba', name: 'C√≥rdoba', shortName: 'CBA',
        type_es: 'Universitario', type_en: 'University District',
        manager: 'Juan P. Morales', size: '580m¬≤',
        revenue: 15_450_680, revPrev: 14_090_750,
        clients: 1567, clientsPrev: 1234,
        avgBasket: 1450, basketPrev: 1325,
        perishable: 78, atRisk: 6,
        health: 'ok',
        waste: { current: 980_000, recovered: 720_000 }
    },
    {
        id: 'mendoza', name: 'Mendoza', shortName: 'MDZ',
        type_es: 'Tur√≠stico-Gastron√≥mico', type_en: 'Tourism-Gastronomic',
        manager: 'Sofia Ruiz', size: '720m¬≤',
        revenue: 26_450_680, revPrev: 24_890_750,
        clients: 1890, clientsPrev: 2156,
        avgBasket: 3650, basketPrev: 3285,
        perishable: 134, atRisk: 18,
        health: 'crit',
        waste: { current: 2_450_000, recovered: 1_650_000 }
    },
    {
        id: 'mar_del_plata', name: 'Mar del Plata', shortName: 'MDP',
        type_es: 'Costero Estacional', type_en: 'Coastal Seasonal',
        manager: 'Roberto Alvarez', size: '890m¬≤',
        revenue: 35_450_680, revPrev: 31_890_750,
        clients: 4567, clientsPrev: 3890,
        avgBasket: 2950, basketPrev: 2785,
        perishable: 167, atRisk: 12,
        health: 'ok',
        waste: { current: 2_700_000, recovered: 2_050_000 }
    }
];

const DECISIONS = [
    {
        id: 'd1', priority: 'critical',
        store: 'Mendoza Centro', storeId: 'mendoza',
        product_es: 'Queso Brie ¬∑ L√°cteos', product_en: 'Brie Cheese ¬∑ Dairy',
        sku: '064',
        riskValue: 186_400, recoveryValue: 134_200,
        cocReturn: 124.3,
        desc_es: '23 unidades ¬∑ Vence en 2 d√≠as ¬∑ Probabilidad exceso: 91%',
        desc_en: '23 units ¬∑ Expires in 2 days ¬∑ Overstock probability: 91%',
        strategy_es: 'Receta Chef 40%', strategy_en: 'Chef Recipe 40%',
        channel: 'Email + WhatsApp',
        targets_es: '756 Turistas Gastron√≥micos (score 91%) + 312 Locales Premium (score 78%)',
        targets_en: '756 Gastronomic Tourists (score 91%) + 312 Premium Locals (score 78%)',
        strategies: [
            { name_es: 'Receta Chef 40%', name_en: 'Chef Recipe 40%', coc: 124.3, color: '#E31E24' },
            { name_es: 'Flash 30%', name_en: 'Flash 30%', coc: 89.7, color: '#f59e0b' },
            { name_es: '2x1 Especial', name_en: 'BOGO Special', coc: 76.4, color: '#10b981' },
            { name_es: 'Loyalty 20%', name_en: 'Loyalty 20%', coc: 52.1, color: '#8b5cf6' },
        ],
        approved: false
    },
    {
        id: 'd2', priority: 'critical',
        store: 'San Isidro', storeId: 'zona_norte',
        product_es: 'Salm√≥n ¬∑ Pescados', product_en: 'Salmon ¬∑ Seafood',
        sku: '041',
        riskValue: 312_800, recoveryValue: 225_000,
        cocReturn: 108.7,
        desc_es: '41 unidades ¬∑ Vence en 3 d√≠as ¬∑ Probabilidad exceso: 84%',
        desc_en: '41 units ¬∑ Expires in 3 days ¬∑ Overstock probability: 84%',
        strategy_es: 'Flash 30%', strategy_en: 'Flash 30%',
        channel: 'Push + Email',
        targets_es: '1,856 Familias Premium (score 88%) + 487 Compradores Habituales (score 83%)',
        targets_en: '1,856 Premium Families (score 88%) + 487 Regular Buyers (score 83%)',
        strategies: [
            { name_es: 'Flash 30%', name_en: 'Flash 30%', coc: 108.7, color: '#f59e0b' },
            { name_es: 'Receta Chef 40%', name_en: 'Chef Recipe 40%', coc: 95.2, color: '#E31E24' },
            { name_es: '2x1 Especial', name_en: 'BOGO Special', coc: 72.3, color: '#10b981' },
            { name_es: 'Loyalty 20%', name_en: 'Loyalty 20%', coc: 48.9, color: '#8b5cf6' },
        ],
        approved: false
    },
    {
        id: 'd3', priority: 'high',
        store: 'Buenos Aires Centro', storeId: 'bsas_centro',
        product_es: 'Palta ¬∑ Frutas', product_en: 'Avocado ¬∑ Produce',
        sku: '004',
        riskValue: 94_600, recoveryValue: 71_000,
        cocReturn: 87.4,
        desc_es: '67 unidades ¬∑ Vence en 4 d√≠as ¬∑ Probabilidad exceso: 76%',
        desc_en: '67 units ¬∑ Expires in 4 days ¬∑ Overstock probability: 76%',
        strategy_es: 'Receta Chef 40%', strategy_en: 'Chef Recipe 40%',
        channel: 'App + WhatsApp',
        targets_es: '856 Ejecutivos en Lunch (score 78%) + 241 Compradores Espor√°dicos (score 71%)',
        targets_en: '856 Business Lunch Clients (score 78%) + 241 Occasional Buyers (score 71%)',
        strategies: [
            { name_es: 'Receta Chef 40%', name_en: 'Chef Recipe 40%', coc: 87.4, color: '#E31E24' },
            { name_es: 'Flash 30%', name_en: 'Flash 30%', coc: 71.2, color: '#f59e0b' },
            { name_es: 'Loyalty 20%', name_en: 'Loyalty 20%', coc: 54.6, color: '#8b5cf6' },
            { name_es: 'Flash 10%', name_en: 'Flash 10%', coc: 28.3, color: '#4a9eff' },
        ],
        approved: false
    },
    {
        id: 'd4', priority: 'high',
        store: 'Mar del Plata', storeId: 'mar_del_plata',
        product_es: 'Langostinos ¬∑ Pescados', product_en: 'King Prawns ¬∑ Seafood',
        sku: '113',
        riskValue: 241_200, recoveryValue: 178_400,
        cocReturn: 94.1,
        desc_es: '35 unidades ¬∑ Vence en 3 d√≠as ¬∑ Probabilidad exceso: 80%',
        desc_en: '35 units ¬∑ Expires in 3 days ¬∑ Overstock probability: 80%',
        strategy_es: 'Flash 30%', strategy_en: 'Flash 30%',
        channel: 'Push + In-store',
        targets_es: '2,856 Veraneantes (score 86%) + 487 Familias Marplatenses (score 72%)',
        targets_en: '2,856 Vacationers (score 86%) + 487 Local Families (score 72%)',
        strategies: [
            { name_es: 'Flash 30%', name_en: 'Flash 30%', coc: 94.1, color: '#f59e0b' },
            { name_es: '2x1 Especial', name_en: 'BOGO Special', coc: 81.3, color: '#10b981' },
            { name_es: 'Receta Chef 40%', name_en: 'Chef Recipe 40%', coc: 76.8, color: '#E31E24' },
            { name_es: 'Loyalty 20%', name_en: 'Loyalty 20%', coc: 45.2, color: '#8b5cf6' },
        ],
        approved: false
    },
    {
        id: 'd5', priority: 'medium',
        store: 'Quilmes', storeId: 'zona_sur',
        product_es: 'Carne Picada ¬∑ Carnes', product_en: 'Ground Beef ¬∑ Meat',
        sku: '031',
        riskValue: 78_400, recoveryValue: 58_200,
        cocReturn: 68.9,
        desc_es: '89 unidades ¬∑ Vence en 4 d√≠as ¬∑ Probabilidad exceso: 72%',
        desc_en: '89 units ¬∑ Expires in 4 days ¬∑ Overstock probability: 72%',
        strategy_es: '2x1 Especial', strategy_en: 'BOGO Special',
        channel: 'In-store + App',
        targets_es: '1,845 Familias Ahorrativas (score 82%) + 241 Clientes Frecuentes (score 69%)',
        targets_en: '1,845 Budget Families (score 82%) + 241 Frequent Shoppers (score 69%)',
        strategies: [
            { name_es: '2x1 Especial', name_en: 'BOGO Special', coc: 68.9, color: '#10b981' },
            { name_es: 'Flash 30%', name_en: 'Flash 30%', coc: 61.4, color: '#f59e0b' },
            { name_es: 'Loyalty 20%', name_en: 'Loyalty 20%', coc: 43.7, color: '#8b5cf6' },
            { name_es: 'Flash 10%', name_en: 'Flash 10%', coc: 21.2, color: '#4a9eff' },
        ],
        approved: false
    },
];

const AI_WINS = [
    { rank: 1, store: 'San Isidro', product_es: 'Bife de Chorizo', product_en: 'Sirloin Steak', strategy_es: 'Receta Chef 40%', strategy_en: 'Chef Recipe 40%', coc: 138.2, saved: '$284K' },
    { rank: 2, store: 'Mar del Plata', product_es: 'Salm√≥n Fresco', product_en: 'Fresh Salmon', strategy_es: 'Flash 30%', strategy_en: 'Flash 30%', coc: 121.6, saved: '$196K' },
    { rank: 3, store: 'Mendoza', product_es: 'Queso de Cabra', product_en: 'Goat Cheese', strategy_es: 'Pack Tur√≠stico', strategy_en: 'Tourist Pack', coc: 114.3, saved: '$143K' },
    { rank: 4, store: 'CABA Centro', product_es: 'Palta Hass', product_en: 'Hass Avocado', strategy_es: 'Loyalty 20%', strategy_en: 'Loyalty 20%', coc: 98.7, saved: '$87K' },
    { rank: 5, store: 'C√≥rdoba', product_es: 'Br√≥coli Premium', product_en: 'Premium Broccoli', strategy_es: 'Combo Estudiante', strategy_en: 'Student Combo', coc: 84.2, saved: '$64K' },
];

const WASTE_TREND = [
    { week_es: 'S-4', week_en: 'W-4', risk: 14.2, recovered: 8.9 },
    { week_es: 'S-3', week_en: 'W-3', risk: 12.8, recovered: 9.4 },
    { week_es: 'S-2', week_en: 'W-2', risk: 16.1, recovered: 12.6 },
    { week_es: 'S-1', week_en: 'W-1', risk: 13.7, recovered: 11.2 },
    { week_es: 'Esta', week_en: 'This', risk: 12.2, recovered: 8.6 },
];

let currentModalDecision = null;

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CLOCK
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function updateClock() {
    const now = new Date();
    const locale = currentLang === 'es' ? 'es-AR' : 'en-US';
    const timeStr = now.toLocaleTimeString(locale, { hour:'2-digit', minute:'2-digit', second:'2-digit' });
    const dateStr = now.toLocaleDateString(locale, { weekday:'long', day:'numeric', month:'long', year:'numeric' });
    document.getElementById('header-time').textContent = timeStr;
    document.getElementById('header-date').textContent = dateStr.charAt(0).toUpperCase() + dateStr.slice(1);
}
setInterval(updateClock, 1000);
updateClock();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// KPI STRIP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderKPIStrip() {
    const totalRev = STORES.reduce((s,st) => s + st.revenue, 0);
    const totalRevPrev = STORES.reduce((s,st) => s + st.revPrev, 0);
    const totalClients = STORES.reduce((s,st) => s + st.clients, 0);
    const totalClientsPrev = STORES.reduce((s,st) => s + st.clientsPrev, 0);
    const avgBasket = Math.round(STORES.reduce((s,st) => s + st.avgBasket, 0) / STORES.length);
    const avgBasketPrev = Math.round(STORES.reduce((s,st) => s + st.basketPrev, 0) / STORES.length);
    const totalAtRisk = STORES.reduce((s,st) => s + st.atRisk, 0);
    const totalWaste = STORES.reduce((s,st) => s + st.waste.current, 0);
    const totalRecovered = STORES.reduce((s,st) => s + st.waste.recovered, 0);
    const recoveryRate = Math.round((totalRecovered / totalWaste) * 100);

    const locale = currentLang === 'es' ? 'es-AR' : 'en-US';
    const kpis = [
        { label: t('kpi_sales'), value: `$${(totalRev/1000000).toFixed(1)}M`, delta: pct(totalRev, totalRevPrev), period: t('period_prev_year'), accent: 100, cls: 'primary' },
        { label: t('kpi_clients'), value: totalClients.toLocaleString(locale), delta: pct(totalClients, totalClientsPrev), period: t('period_prev_week'), accent: 75 },
        { label: t('kpi_basket'), value: `$${avgBasket.toLocaleString(locale)}`, delta: pct(avgBasket, avgBasketPrev), period: t('period_prev_month'), accent: 60 },
        { label: t('kpi_risk'), value: totalAtRisk, delta: null, period: t('period_branches', {n: STORES.length}), valCls: 'amber', accent: 0, cls: 'alert' },
        { label: t('kpi_recovery'), value: `${recoveryRate}%`, delta: { val: '+12pp', up: true }, period: t('period_no_ai'), valCls: 'green', accent: recoveryRate },
    ];

    document.getElementById('kpi-strip').innerHTML = kpis.map(k => `
        <div class="kpi-cell ${k.cls||''}">
            <div class="kpi-label">${k.label}</div>
            <div class="kpi-value ${k.valCls||''}">${k.value}</div>
            <div class="kpi-meta">
                ${k.delta ? `<span class="delta ${k.delta.up!==false?'up':'down'}">${k.delta.val||k.delta}</span>` : ''}
                <span class="delta-period">${k.period}</span>
            </div>
            <div class="kpi-accent-bar" style="width:${k.accent}%"></div>
        </div>
    `).join('');
}

function pct(curr, prev) {
    const ch = ((curr - prev) / prev * 100);
    return { val: `${ch>=0?'‚ñ≤':'‚ñº'} ${Math.abs(ch).toFixed(1)}%`, up: ch >= 0 };
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DECISIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderDecisions() {
    const pending = DECISIONS.filter(d => !d.approved);
    document.getElementById('decisions-count').textContent = pending.length;

    document.getElementById('decisions-list').innerHTML = DECISIONS.map(d => {
        const prioClass = d.priority === 'critical' ? 'priority-critical' : d.priority === 'high' ? 'priority-high' : 'priority-medium';
        const product = d[`product_${currentLang}`] || d.product_es;
        const desc = d[`desc_${currentLang}`] || d.desc_es;
        const strategy = d[`strategy_${currentLang}`] || d.strategy_es;
        return `
        <div class="decision-row" id="drow-${d.id}" onclick="openDecisionModal('${d.id}')">
            <div class="decision-priority-bar ${prioClass}"></div>
            <div class="decision-body">
                <div class="decision-store">${d.store} ¬∑ ${d.storeId.toUpperCase()}</div>
                <div class="decision-product">${product}</div>
                <div class="decision-detail">${desc}</div>
                <div class="decision-tags">
                    <span class="dtag red">${t('risk_tag').replace('${v}', (d.riskValue/1000).toFixed(0))}</span>
                    <span class="dtag green">${t('recovery_tag').replace('${v}', (d.recoveryValue/1000).toFixed(0))}</span>
                    <span class="dtag amber">${strategy}</span>
                    <span class="dtag">${d.channel}</span>
                </div>
            </div>
            <div class="decision-action">
                <div class="decision-recovery-label">${t('coc_return')}</div>
                <div class="decision-recovery">${d.cocReturn.toFixed(1)}%</div>
                <button class="approve-btn ${d.approved?'approved':''}" id="abtn-${d.id}" onclick="event.stopPropagation(); approveDecision('${d.id}')">${d.approved ? t('approved') : t('approve')}</button>
                <button class="preview-btn" onclick="event.stopPropagation(); openDecisionModal('${d.id}')">${t('see_detail')}</button>
            </div>
        </div>`;
    }).join('');
}

function approveDecision(id) {
    const d = DECISIONS.find(d => d.id === id);
    d.approved = true;
    const btn = document.getElementById(`abtn-${id}`);
    btn.textContent = t('approved');
    btn.classList.add('approved');
    document.getElementById(`drow-${id}`).style.opacity = '0.55';
    document.getElementById('decisions-count').textContent = DECISIONS.filter(d => !d.approved).length;
    if (currentModalDecision && currentModalDecision.id === id) {
        document.getElementById('modal-approve').textContent = t('campaign_approved');
        document.getElementById('modal-approve').style.background = '#00d68f';
    }
}

function approveAll() {
    DECISIONS.forEach(d => { if(!d.approved) approveDecision(d.id); });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DECISION MODAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function openDecisionModal(id) {
    const d = DECISIONS.find(d => d.id === id);
    currentModalDecision = d;
    const product = d[`product_${currentLang}`] || d.product_es;
    const desc = d[`desc_${currentLang}`] || d.desc_es;
    const strategy = d[`strategy_${currentLang}`] || d.strategy_es;
    const targets = d[`targets_${currentLang}`] || d.targets_es;

    document.getElementById('modal-title').textContent = product;
    document.getElementById('modal-subtitle').textContent = `${d.store} ¬∑ SKU ${d.sku} ¬∑ ${desc}`;

    document.getElementById('modal-metrics').innerHTML = `
        <div class="modal-metric">
            <div class="modal-metric-val" style="color:var(--red);">$${(d.riskValue/1000).toFixed(0)}K</div>
            <div class="modal-metric-lbl">${t('value_at_risk')}</div>
        </div>
        <div class="modal-metric">
            <div class="modal-metric-val" style="color:var(--green);">$${(d.recoveryValue/1000).toFixed(0)}K</div>
            <div class="modal-metric-lbl">${t('est_recovery')}</div>
        </div>
        <div class="modal-metric">
            <div class="modal-metric-val" style="color:var(--green);">${d.cocReturn.toFixed(1)}%</div>
            <div class="modal-metric-lbl">${t('coc_return_lbl')}</div>
        </div>
        <div class="modal-metric">
            <div class="modal-metric-val">${strategy}</div>
            <div class="modal-metric-lbl">${t('optimal_strategy')}</div>
        </div>
    `;

    const maxCoc = Math.max(...d.strategies.map(s=>s.coc));
    document.getElementById('modal-strats').innerHTML = d.strategies.map(s => {
        const w = Math.max(10, (s.coc/maxCoc)*100);
        const isBest = s.coc === maxCoc;
        const name = s[`name_${currentLang}`] || s.name_es;
        return `
        <div class="strat-row">
            <div class="strat-name">${name} ${isBest ? '‚Üê' : ''}</div>
            <div class="strat-bar-wrap">
                <div class="strat-bar-fill" style="width:${w}%; background:${s.color}${isBest?'':80}; opacity:${isBest?1:0.6};">
                    <span>${s.coc.toFixed(1)}%</span>
                </div>
            </div>
        </div>`;
    }).join('');

    document.getElementById('modal-customers').textContent = targets;

    const approveBtn = document.getElementById('modal-approve');
    if (d.approved) { approveBtn.textContent = t('campaign_approved'); approveBtn.style.background = '#00d68f'; }
    else { approveBtn.querySelector('span').textContent = currentLang === 'es' ? 'Aprobar y Lanzar' : 'Approve and Launch'; approveBtn.style.background = ''; }

    document.getElementById('modal-overlay').classList.add('open');
}

function approveFromModal() {
    if (currentModalDecision) approveDecision(currentModalDecision.id);
}
function closeModal(e) { if (e.target.id === 'modal-overlay') closeModalDirect(); }
function closeModalDirect() { document.getElementById('modal-overlay').classList.remove('open'); currentModalDecision = null; }

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NETWORK ROWS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderNetworkRows() {
    const maxRev = Math.max(...STORES.map(s=>s.revenue));
    document.getElementById('network-rows').innerHTML = STORES.map(s => {
        const barW = Math.round((s.revenue/maxRev)*100);
        const revDelta = ((s.revenue - s.revPrev)/s.revPrev*100).toFixed(1);
        const barColor = s.health==='ok' ? '#00d68f' : s.health==='warn' ? '#f59e0b' : '#E31E24';
        const type = s[`type_${currentLang}`] || s.type_es;
        return `
        <div class="network-row" onclick="showStoreDetail('${s.id}')">
            <div class="network-row-top">
                <div>
                    <span class="network-store-name">${s.name}</span>
                    <span class="health-dot" style="background:${barColor};"></span>
                </div>
                <div class="network-revenue">$${(s.revenue/1000000).toFixed(1)}M</div>
            </div>
            <div class="network-row-bottom">
                <div class="network-store-type">${type}</div>
                <div class="network-bar-wrap"><div class="network-bar" style="width:${barW}%; background:${barColor};"></div></div>
                <div class="network-metrics">
                    <span class="nmval ${revDelta>=0?'good':'danger'}">${revDelta>=0?'‚ñ≤':'‚ñº'}${Math.abs(revDelta)}%</span>
                    <span class="nmval danger">${s.atRisk}‚ö†</span>
                </div>
            </div>
        </div>`;
    }).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STORE SCORECARDS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderScorecards() {
    document.getElementById('store-scorecards').innerHTML = STORES.map(s => {
        const revDelta = ((s.revenue-s.revPrev)/s.revPrev*100).toFixed(1);
        const recoveryRate = Math.round((s.waste.recovered/s.waste.current)*100);
        const aiOpp = Math.round((s.waste.current - s.waste.recovered) * 0.65 / 1000);
        const healthLabel = { ok: t('health_s_ok'), warn: t('health_s_warn'), crit: t('health_s_crit') }[s.health];
        const type = s[`type_${currentLang}`] || s.type_es;
        const locale = currentLang === 'es' ? 'es-AR' : 'en-US';
        return `
        <div class="scorecard" onclick="showStoreDetail('${s.id}')">
            <div class="sc-header">
                <div>
                    <div class="sc-name">${s.name}</div>
                    <div class="sc-type">${type} ¬∑ ${s.size}</div>
                </div>
                <div class="sc-health health-${s.health}">${healthLabel}</div>
            </div>
            <div class="sc-metrics">
                <div class="sc-m">
                    <div class="sc-m-val" style="color:${revDelta>=0?'var(--green)':'var(--red)'}; font-size:0.8rem;">${revDelta>=0?'‚ñ≤':'‚ñº'} ${Math.abs(revDelta)}%</div>
                    <div class="sc-m-lbl">${t('sales_ytd')}</div>
                </div>
                <div class="sc-m">
                    <div class="sc-m-val">$${s.avgBasket.toLocaleString(locale)}</div>
                    <div class="sc-m-lbl">${t('avg_ticket')}</div>
                </div>
                <div class="sc-m">
                    <div class="sc-m-val">${s.clients.toLocaleString(locale)}</div>
                    <div class="sc-m-lbl">${t('clients')}</div>
                </div>
                <div class="sc-m">
                    <div class="sc-m-val" style="color:var(--amber);">${s.atRisk}</div>
                    <div class="sc-m-lbl">${t('risk_skus')}</div>
                </div>
                <div class="sc-m">
                    <div class="sc-m-val" style="color:var(--green);">${recoveryRate}%</div>
                    <div class="sc-m-lbl">${t('ai_rec')}</div>
                </div>
                <div class="sc-m">
                    <div class="sc-m-val">${s.employees||'‚Äî'}</div>
                    <div class="sc-m-lbl">${t('employees')}</div>
                </div>
            </div>
            <div class="sc-footer">
                <div class="sc-ai-opp">${t('ai_opp')}: <strong>$${aiOpp}K</strong> ${t('recoverable')}</div>
                <div class="sc-manager">${s.manager}</div>
            </div>
        </div>`;
    }).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// WASTE TREND CHART
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderWasteChart() {
    const maxVal = Math.max(...WASTE_TREND.map(w => Math.max(w.risk, w.recovered)));
    document.getElementById('waste-chart').innerHTML = WASTE_TREND.map(w => {
        const riskH = Math.round((w.risk/maxVal)*100);
        const recH = Math.round((w.recovered/maxVal)*100);
        const riskLbl = t('chart_risk_label').replace('${v}', w.risk);
        const recLbl = t('chart_rec_label').replace('${v}', w.recovered);
        return `
        <div class="bar-group">
            <div class="bar bar-risk" style="height:${riskH}%;" data-val="${riskLbl}"></div>
            <div class="bar bar-recovered" style="height:${recH}%;" data-val="${recLbl}"></div>
        </div>`;
    }).join('');

    document.getElementById('waste-chart-labels').innerHTML = WASTE_TREND.map(w=>`<div class="bar-label">${w[`week_${currentLang}`]||w.week_es}</div>`).join('');

    const totalRisk = WASTE_TREND.reduce((s,w)=>s+w.risk,0);
    const totalRec = WASTE_TREND.reduce((s,w)=>s+w.recovered,0);
    const avgRec = Math.round((totalRec/totalRisk)*100);
    document.getElementById('waste-chart-footer').innerHTML = `
        <div class="chart-stat">
            <div class="chart-stat-val" style="color:var(--red);">$${totalRisk.toFixed(1)}M</div>
            <div class="chart-stat-lbl">${t('chart_total_risk')}</div>
        </div>
        <div class="chart-stat">
            <div class="chart-stat-val" style="color:var(--green);">$${totalRec.toFixed(1)}M</div>
            <div class="chart-stat-lbl">${t('chart_recovered').replace('${pct}', avgRec)}</div>
        </div>`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// AI WINS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderWins() {
    document.getElementById('wins-list').innerHTML = AI_WINS.map(w => `
        <div class="win-row">
            <div class="win-rank">#${w.rank}</div>
            <div class="win-body">
                <div class="win-name">${w[`product_${currentLang}`]||w.product_es}</div>
                <div class="win-detail">${w.store} ¬∑ ${w[`strategy_${currentLang}`]||w.strategy_es}</div>
            </div>
            <div class="win-metric">
                <div class="win-coc">${w.coc.toFixed(1)}%</div>
                <div class="win-coc-lbl">${w.saved}</div>
            </div>
        </div>`).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// WASTE SUMMARY & MODEL STATUS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderWasteSummary() {
    const totalWaste = STORES.reduce((s,st)=>s+st.waste.current,0);
    const totalRec = STORES.reduce((s,st)=>s+st.waste.recovered,0);
    const netExposure = totalWaste - totalRec;
    const aiCapture = Math.round((totalRec/totalWaste)*100);

    document.getElementById('waste-summary').innerHTML = `
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <div style="font-size:0.72rem; color:var(--text-3);">${t('gross_exposure')}</div>
            <div style="font-family:var(--mono); color:var(--red);">$${(totalWaste/1000000).toFixed(2)}M</div>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <div style="font-size:0.72rem; color:var(--text-3);">${t('recovered_ai')}</div>
            <div style="font-family:var(--mono); color:var(--green);">$${(totalRec/1000000).toFixed(2)}M</div>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center; padding-top:0.5rem; border-top:1px solid var(--border);">
            <div style="font-size:0.72rem; color:var(--text-2); font-weight:600;">${t('net_exposure')}</div>
            <div style="font-family:var(--mono); font-size:1.1rem; color:var(--amber);">$${(netExposure/1000000).toFixed(2)}M</div>
        </div>
        <div style="margin-top:0.5rem;">
            <div style="display:flex; justify-content:space-between; font-size:0.68rem; color:var(--text-3); margin-bottom:0.375rem;">
                <span>${t('ai_capture')}</span><span style="color:var(--green); font-family:var(--mono);">${aiCapture}%</span>
            </div>
            <div style="background:var(--bg-4); border-radius:2px; height:8px; overflow:hidden;">
                <div style="height:100%; width:${aiCapture}%; background:var(--green); border-radius:2px;"></div>
            </div>
        </div>`;

    document.getElementById('model-status').innerHTML = `
        <div style="display:flex; justify-content:space-between; align-items:center; font-size:0.75rem;">
            <span style="color:var(--text-3);">XGBoost Overstock Model</span>
            <span style="font-family:var(--mono); color:var(--green); font-size:0.68rem;">RMSE 0.073 ¬∑ AUC 0.89</span>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center; font-size:0.75rem;">
            <span style="color:var(--text-3);">Customer Propensity Model</span>
            <span style="font-family:var(--mono); color:var(--green); font-size:0.68rem;">Precision 0.84 ¬∑ F1 0.81</span>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center; font-size:0.75rem;">
            <span style="color:var(--text-3);">Monte Carlo Simulation</span>
            <span style="font-family:var(--mono); color:var(--green); font-size:0.68rem;">10K iter ¬∑ IC 95%</span>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center; font-size:0.75rem;">
            <span style="color:var(--text-3);">${t('last_retrain')}</span>
            <span style="font-family:var(--mono); color:var(--text-2); font-size:0.68rem;">${t('today')} 04:30 AM</span>
        </div>`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ALERTS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderAlerts() {
    const types = ['crit','crit','warn','warn','info','info','info','warn'];
    const alerts = T[currentLang].alerts;
    document.getElementById('alerts-scroll').innerHTML = alerts.map((text,i)=>`
        <div class="alert-chip ${types[i]}">${text}</div>`).join('');
}

function showStoreDetail(storeId) { console.log('Store:', storeId); }
function handleAlert(type) {}

function exportDashboard() {
    const locale = currentLang === 'es' ? 'es-AR' : 'en-US';
    const msg = t('export_msg');
    alert(msg + new Date().toLocaleDateString(locale).replace(/\//g,'-') + '.pdf');
}

function init() {
    renderKPIStrip();
    renderDecisions();
    renderNetworkRows();
    renderScorecards();
    renderWasteChart();
    renderWins();
    renderWasteSummary();
    renderAlerts();
}

document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
